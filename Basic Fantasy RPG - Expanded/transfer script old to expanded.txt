<script type=“text/worker”>
on("sheet:opened", function() {
  getAttrs(['list', 'of', 'attrs', 'on', 'the', 'old', 'sheet', 'already_transitioned'], function(attrs) {
      if(attr.already_transitioned !== '1') {
          var hasOldData = false;
          var updates = {};
          _.each(attrs, function(value, key) {
              if(value) {
                  hasOldData = true;
              }
          });
          if(!hasOldData) {
              updates.already_transitioned = '1';
              setAttrs(updates);
          }
          else {
              getAttrs(['list', 'of', 'all', 'attrs', 'on', 'the', 'old', 'sheet'], function(oldAttrs) {
                  attr_character_name = attr_name;
                  attr_strength = attr_STR;
                  attr_intelligence = attr_INT;
                  attr_wisdom = attr_WIS;
                  attr_dexterity = attr_DEX;
                  attr_constitution = attr_CON;
                  attr_charisma = attr_CHA;
                  attr_HP_max = attr_hp_max;
                  attr_HP = attr_hp;
                  attr_ab = attr_ab_normal;
                  attr_move_encounter = attr_movement;
                  attr_current_xp = attr_currentxp;
                  attr_xp_next_level = attr_xpnextlevel;
                  attr_save_death_ray = attr_deathrayorpoison;
                  attr_save_magic_wand = attr_magicwands;
                  attr_save_paralysis = attr_paralysispetrification;
                  attr_save_dragons_breath = attr_dragonbreath;
                  attr_save_rod_staff_spell = attr_rodsstavesspells;
                  attr_lootnotes = attr_money;
                  updates.already_transitioned = '1';
                  setAttrs(updates);
              });
          }
      }
  });
});
</script>