<!-- Metal Adventures  -->
<!-- by Jaufré Devosse -->
<!-- Version 0.0.1     -->
<html>

<head>
	<title>test</title>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="MetalAdventures.css">
</head>

<body class="charsheet">
	<img src="https://i.imgur.com/olYZbbgl.jpg">
	<div class="row">
		<div class="columnFlex">
			<div class="row">
				<div class="columnFlex"><label>Nom: </label></div>
				<div class="columnFlex">
					<input type="text" name="attr_character_name">
				</div>
			</div>
			<div class="row">
				<div class="columnFlex"><label>Archétype: </label></div>
				<div class="columnFlex">
					<input type="text" name="attr_archetype">
				</div>
			</div>
			<div class="row">
				<div class="columnFlex"><label>Origine: </label></div>
				<div class="columnFlex">
					<input type="text" name="attr_origine">
				</div>
			</div>
			<div class="row">
				<div class="columnFlex"><label>Sexe: </label></div>
				<div class="columnFlex">
					<input type="text" name="attr_sexe">
				</div>
			</div>
			<div class="row">
				<div class="columnFlex">
					<label>Mutant: </label>
				</div>
				<div class="columnFlex">
					<input type="checkbox" name="attr_mutant" value="1">Oui
					<input type="checkbox" name="attr_mutant" value="0" checked="true">Non
				</div>
			</div>
		</div>
		<div class="columnFlex">
			<div class="row">
				<div class="columnFlex"></div>
				<div class="columnFlex">test</div>
			</div>
			<div class="row">
				<div class="columnFlex"><label>Indemne</label></div>
				<div class="columnFlex">
					<input type="number" name="attr_Indemne">
					<input type="number" name="attr_Indemne_max">
				</div>
			</div>
			<div class="row">
				<div class="columnFlex"><label>Blessé léger</label></div>
				<div class="columnFlex">
					<input type="number" name="attr_BlesseLeger">
					<input type="number" name="attr_BlesseLeger_max">
				</div>
			</div>
			<div class="row">
				<div class="columnFlex"><label>Blessé grave</label></div>
				<div class="columnFlex">
					<input type="number" name="attr_BlesseGrave">
					<input type="number" name="attr_BlesseGrave_max">
				</div>
			</div>
			<div class="row">
				<div class="columnFlex"><label>Mort ?</label></div>
				<div class="columnFlex">
					<input type="number" name="attr_Mort">
					<input type="number" name="attr_Mort_max">
				</div>
			</div>
		</div>
	</div>
	<div class="row">
		<!-- Agilité -->
		<div class="columnFlex">
			<div class="column-header">Agilité</div>
			<div class="row">
				<div class="columnFlex">
					<span><input type="checkbox" name="attr_predilection_Technique" value="0">Techniques</span>
				</div>
				<input type="number" name="attr_Technique" value="0">
			</div>
			<div class="row">
				<div class="columnFlex">
					<span>Acrobaties</span>
				</div>
				<div>
					<input type="number" name="attr_Acrobatie">
					<input type="number" name="attr_Acrobatie_max" readonly>
				</div>
			</div>
			<div class="row">
				<div class="columnFlex">
					<span class="mf">Armes de poings</span>
				</div>
				<div>
					<input type="number" name="attr_ArmesDePoing">
					<input type="number" name="attr_ArmesDePoing_max" readonly>
				</div>
			</div>
			<div class="row">
				<div class="columnFlex">
					<span class="mf">Armes d'épaule</span>
				</div>
				<div>
					<input type="number" name="attr_ArmesDEpaule">
					<input type="number" name="attr_ArmesDEpaule_max" readonly>
				</div>
			</div>
			<div class="row">
				<div class="columnFlex">
					<span class="mf">[Armes embarquée]</span>
				</div>
				<div>
					<input type="number" name="attr_ArmesEmbarquee">
					<input type="number" name="attr_ArmesEmbarquee_max" readonly>
				</div>
			</div>
			<div class="row">
				<div class="columnFlex">
					<span>Artisanat (<input type="text" name="attr_ArtisanatLabel">)</span>
				</div>
				<div>
					<input type="number" name="attr_Artisanat">
					<input type="number" name="attr_Artisanat_max" readonly>
				</div>
			</div>
			<div class="row">
				<div class="columnFlex">
					<span class="mf">[Pilotage (<input type="text" name="attr_Pilotage1Label">)</span>
				</div>
				<div>
					<input type="number" name="attr_Pilotage1">
					<input type="number" name="attr_Pilotage1_max" readonly>
				</div>
			</div>
			<div class="row">
				<div class="columnFlex">
					<span class="mf">[Pilotage (<input type="text" name="attr_Pilotage2Label">)</span>
				</div>
				<div>
					<input type="number" name="attr_Pilotage2">
					<input type="number" name="attr_Pilotage2_max" readonly>
				</div>
			</div>
			<div class="row">
				<div class="columnFlex">
					<span>Technologie</span>
				</div>
				<div>
					<input type="number" name="attr_Technologie">
					<input type="number" name="attr_Technologie_max" readonly>
				</div>
			</div>
		</div>
		<!-- Carrure -->
		<div class="columnFlex">
			<div class="column-header">Carrure</div>

			<div class="row">
				<div class="columnFlex">
					<span><input type="checkbox" name="attr_predilection_survie" value="0">Survie</span>
				</div>
				<input type="number" name="attr_Survie" value="0">
			</div>

			<div class="row">
				<div class="columnFlex">
					<span class="mf">Armes de jet</span>
				</div>
				<div>
					<input type="number" name="attr_ArmesdeJet">
					<input type="number" name="attr_ArmesdeJet_max" readonly>
				</div>
			</div>
			<div class="row">
				<div class="columnFlex">
					<span class="mf">[Armes lourdes]</span>
				</div>
				<div>
					<input type="number" name="attr_ArmesLourdes">
					<input type="number" name="attr_ArmesLourdes_max" readonly>
				</div>
			</div>
			<div class="row">
				<div class="columnFlex">
					<span>Athlétisme</span>
				</div>
				<div>
					<input type="number" name="attr_Athletisme">
					<input type="number" name="attr_Athletisme_max" readonly>
				</div>
			</div>
			<div class="row">
				<div class="columnFlex">
					<span>Équitation</span>
				</div>
				<div>
					<input type="number" name="attr_Equitation">
					<input type="number" name="attr_Equitation_max" readonly>
				</div>
			</div>
			<div class="row">
				<div class="columnFlex">
					<span class="mf">Mêlée</span>
				</div>
				<div>
					<input type="number" name="attr_Melee">
					<input type="number" name="attr_Melee_max" readonly>
				</div>
			</div>
			<div class="row">
				<div class="columnFlex">
					<span>Environement (<input type="text" name="attr_Environement1Label">)</span>
				</div>
				<div>
					<input type="number" name="attr_Environement1">
					<input type="number" name="attr_Environement1_max" readonly>
				</div>
			</div>
			<div class="row">
				<div class="columnFlex">
					<span>Environement (<input type="text" name="attr_Environement2Label">)</span>
				</div>
				<div>
					<input type="number" name="attr_Environement2">
					<input type="number" name="attr_Environement2_max" readonly>
				</div>
			</div>
			<div class="row">
				<div class="columnFlex">
					<span>Environement (<input type="text" name="attr_Environement3Label">)</span>
				</div>
				<div>
					<input type="number" name="attr_Environement3">
					<input type="number" name="attr_Environement3_max" readonly>
				</div>
			</div>
		</div>
		<!-- Perception -->
		<div class="columnFlex">
			<div class="column-header">Perception</div>
			<div class="row">
				<div class="columnFlex">
					<span><input type="checkbox" name="attr_predilection_espionnage" value="0">Espionnage</span>
				</div>
				<input type="number" name="attr_Espionnage" value="0">
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Déguisement</span>
				</div>
				<div>
					<input type="number" name="attr_Deguisement">
					<input type="number" name="attr_Deguisement_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Discrétion</span>
				</div>
				<div>
					<input type="number" name="attr_Discretion">
					<input type="number" name="attr_Discretion_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Empathie</span>
				</div>
				<div>
					<input type="number" name="attr_Empathie">
					<input type="number" name="attr_Empathie_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>[Falsification]</span>
				</div>
				<div>
					<input type="number" name="attr_Falsification">
					<input type="number" name="attr_Falsification_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Recherche</span>
				</div>
				<div>
					<input type="number" name="attr_Recherche">
					<input type="number" name="attr_Recherche_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>[Senseurs]</span>
				</div>
				<div>
					<input type="number" name="attr_Senseurs">
					<input type="number" name="attr_Senseurs_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>[Sys. Sécu]</span>
				</div>
				<div>
					<input type="number" name="attr_SysSecu">
					<input type="number" name="attr_SysSecu_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Vigilance</span>
				</div>
				<div>
					<input type="number" name="attr_Vigilance">
					<input type="number" name="attr_Vigilance_max" readonly>
				</div>
			</div>
		</div>
	</div>
	<div class="row">
		<!-- Intellingence -->
		<div class="columnFlex">
			<div class="column-header">Intellingence</div>

			<div class="row">
				<div class="columnFlex">
					<span><input type="checkbox" name="attr_predilection_Science" value="0">Science</span>
				</div>
				<input type="number" name="attr_Science" value="0">
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Analyse</span>
				</div>
				<div>
					<input type="number" name="attr_Analyse">
					<input type="number" name="attr_Analyse_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Arts(<input type="text" name="attr_ArtsLabel">)</span>
				</div>
				<div>
					<input type="number" name="attr_Art">
					<input type="number" name="attr_Art_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Connaissance (<input type="text" name="attr_Connaissance1Label">)</span>
				</div>
				<div>
					<input type="number" name="attr_Connaissance1">
					<input type="number" name="attr_Connaissance1_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Connaissance (<input type="text" name="attr_Connaissance2Label">)</span>
				</div>
				<div>
					<input type="number" name="attr_Connaissance2">
					<input type="number" name="attr_Connaissance2_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Connaissance (<input type="text" name="attr_Connaissance3Label">)</span>
				</div>
				<div>
					<input type="number" name="attr_Connaissance3">
					<input type="number" name="attr_Connaissance3_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>[Ésotérisme]</span>
				</div>
				<div>
					<input type="number" name="attr_Esoterisme">
					<input type="number" name="attr_Esoterisme_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Histoire</span>
				</div>
				<div>
					<input type="number" name="attr_Histoire">
					<input type="number" name="attr_Histoire_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>[Ingénierie]</span>
				</div>
				<div>
					<input type="number" name="attr_Ingenierie">
					<input type="number" name="attr_Ingenierie_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>[Médecine]</span>
				</div>
				<div>
					<input type="number" name="attr_Medecine">
					<input type="number" name="attr_Medecine_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Navigation</span>
				</div>
				<div>
					<input type="number" name="attr_Navigation">
					<input type="number" name="attr_Navigation_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>[Sciences Solaires]</span>
				</div>
				<div>
					<input type="number" name="attr_SciencesSolaires">
					<input type="number" name="attr_SciencesSolaires_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>[Sciences Stellaires]</span>
				</div>
				<div>
					<input type="number" name="attr_SciencesStellaires">
					<input type="number" name="attr_SciencesStellaires_max" readonly>
				</div>
			</div>
		</div>

		<div class="columnFlex">
			<div class="column-header">Présence</div>

			<div class="row">
				<div class="columnFlex">
					<span><input type="checkbox" name="attr_predilection_Negociation" value="0">Negociation</span>
				</div>
				<input type="number" name="attr_Negociation" value="0">
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Baration</span>
				</div>
				<div class="g">
					<input type="number" name="attr_Baration">
					<input type="number" name="attr_Baration_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Bureaucratie</span>
				</div>
				<div class="g">
					<input type="number" name="attr_Bureaucratie">
					<input type="number" name="attr_Bureaucratie_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Comédie</span>
				</div>
				<div class="g">
					<input type="number" name="attr_Comedie">
					<input type="number" name="attr_Comedie_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Commerce</span>
				</div>
				<div class="g">
					<input type="number" name="attr_Commerce">
					<input type="number" name="attr_Commerce_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Danse</span>
				</div>
				<div class="g">
					<input type="number" name="attr_Danse">
					<input type="number" name="attr_Danse_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Éloquence</span>
				</div>
				<div class="g">
					<input type="number" name="attr_Eloquence">
					<input type="number" name="attr_Eloquence_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Étiquette</span>
				</div>
				<div class="g">
					<input type="number" name="attr_Etiquette">
					<input type="number" name="attr_Etiquette_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Jeux</span>
				</div>
				<div class="g">
					<input type="number" name="attr_Jeux">
					<input type="number" name="attr_Jeux_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span class="mf">Séduction</span>
				</div>
				<div class="g">
					<input type="number" name="attr_Seduction">
					<input type="number" name="attr_Seduction_max" readonly>
				</div>
			</div>
		</div>

		<div class="columnFlex">
			<div class="column-header">Sang-froid</div>

			<div class="row">
				<div class="columnFlex">
					<span><input type="checkbox" name="attr_predilection_Trempe" value="0">Trempe</span>
				</div>
				<input type="number" name="attr_Trempe" value="0">
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Commandement</span>
				</div>
				<div class="g">
					<input type="number" name="attr_Commandement">
					<input type="number" name="attr_Commandement_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span class="mf">[Démolition]</span>
				</div>
				<div>
					<input type="number" name="attr_Demolition">
					<input type="number" name="attr_Demolition_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span class="mf">Détermination</span>
				</div>
				<div>
					<input type="number" name="attr_Determination">
					<input type="number" name="attr_Determination_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Dressage</span>
				</div>
				<div>
					<input type="number" name="attr_Dressage">
					<input type="number" name="attr_Dressage_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Illégalités</span>
				</div>
				<div class="g">
					<input type="number" name="attr_Illegalites">
					<input type="number" name="attr_Illegalites_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span class="mf">Intimidation</span>
				</div>
				<div class="g">
					<input type="number" name="attr_Intimidation">
					<input type="number" name="attr_Intimidation_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Premiers soins</span>
				</div>
				<div>
					<input type="number" name="attr_Premierssoins">
					<input type="number" name="attr_Premierssoins_max" readonly>
				</div>
			</div>

			<div class="row">
				<div class="columnFlex">
					<span>Tactique</span>
				</div>
				<div>
					<input type="number" name="attr_Tactique">
					<input type="number" name="attr_Tactique_max" readonly>
				</div>
			</div>

		</div>
	</div>

	<script type="text/worker">

on('sheet:opened',function(){
});

on("change:Technique change:Acrobatie change:ArmesDePoing change:ArmesDEpaule change:ArmesEmbarquee change:Artisanat change:Pilotage1 change:Pilotage2 change:Technologie", function() {
    getAttrs(["Technique", "Acrobatie", "ArmesDePoing", "ArmesDEpaule", "ArmesEmbarquee", "Artisanat", "Pilotage1", "Pilotage2", "Technologie"], function(values) {
       setAttrs({
			Acrobatie_max: +values.Technique + +values.Acrobatie, 
			ArmesDePoing_max: +values.Technique + +values.ArmesDePoing, 
			ArmesDEpaule_max: +values.Technique + +values.ArmesDEpaule, 
			ArmesEmbarquee_max: +values.ArmesEmbarquee > 0 ? +values.Technique + +values.ArmesEmbarquee:0, 
			Artisanat_max: +values.Technique + +values.Artisanat, 
			Pilotage1_max: +values.Pilotage1>0?+values.Technique + +values.Pilotage1:0, 
			Pilotage2_max: +values.Pilotage2>0?+values.Technique + +values.Pilotage2:0, 
			Technologie_max: +values.Technique + +values.Technologie
		});
   });
});

on("change:Survie change:ArmesdeJet change:ArmesLourdes change:Athletisme change:Equitation change:Melee change:Environement1 change:Environement2 change:Environement3", function() {
    getAttrs(["Survie", "ArmesdeJet", "ArmesLourdes", "Athletisme", "Equitation", "Melee", "Environement1", "Environement2", "Environement3"], function(values) {
       setAttrs({
			ArmesdeJet_max: +values.Survie + +values.ArmesdeJet, 
			ArmesLourdes_max: +values.ArmesLourdes > 0 ? +values.Survie + +values.ArmesLourdes:0, 
			Athletisme_max: +values.Survie + +values.Athletisme, 
			Equitation_max: +values.Survie + +values.Equitation, 
			Melee_max: +values.Survie + +values.Melee, 
			Environement1_max: +values.Survie + +values.Environement1, 
			Environement2_max: +values.Survie + +values.Environement2, 
			Environement3_max: +values.Survie + +values.Environement3, 
		});
   });
});

on("change:Espionnage change:Deguisement change:Discretion change:Empathie change:Falsification change:Recherche change:Senseurs change:SysSecu change:Vigilance", function() {
    getAttrs(["Espionnage", "Deguisement", "Discretion", "Empathie", "Falsification", "Recherche", "Senseurs", "SysSecu", "Vigilance"], function(values) {
       setAttrs({
			Deguisement_max: +values.Espionnage + +values.Deguisement, 
			Discretion_max: +values.Espionnage + +values.Discretion, 
			Empathie_max: +values.Espionnage + +values.Empathie, 
			Falsification_max: +values.Falsification > 0 ? +values.Espionnage + +values.Falsification:0, 
			Recherche_max: +values.Espionnage + +values.Recherche, 
			Senseurs_max: +values.Senseurs > 0 ? +values.Espionnage + +values.Senseurs:0, 
			SysSecu_max: +values.SysSecu > 0 ? +values.Espionnage + +values.SysSecu:0, 
			Vigilance_max: +values.Espionnage + +values.Vigilance, 
		});
   });
});

on("change:Science change:Analyse change:Art change:Connaissance1 change:Connaissance2 change:Connaissance3 change:Esoterisme change:Histoire change:Ingenierie change:Medecine change:Navigation change:SciencesSolaires change:SciencesStellaires", function() {
    getAttrs(["Science", "Analyse", "Art", "Connaissance1", "Connaissance2", "Connaissance3", "Esoterisme", "Histoire", "Ingenierie", "Medecine", "Navigation", "SciencesSolaires", "SciencesStellaires"], function(values) {
       setAttrs({
			Analyse_max: +values.Science + +values.Analyse, 
			Art_max: +values.Science + +values.Art, 
			Connaissance1_max: +values.Science + +values.Connaissance1, 
			Connaissance2_max: +values.Science + +values.Connaissance2, 
			Connaissance3_max: +values.Science + +values.Connaissance3, 
			Esoterisme_max: +values.Esoterisme > 0 ? +values.Science + +values.Esoterisme:0, 
			Histoire_max: +values.Science + +values.Histoire, 
			Ingenierie_max: +values.Ingenierie > 0 ? +values.Science + +values.Ingenierie:0, 
			Medecine_max: +values.Medecine > 0 ? +values.Science + +values.Medecine:0, 
			Navigation_max: +values.Science + +values.Navigation, 
			SciencesSolaires_max: +values.SciencesSolaires > 0 ? +values.Science + +values.SciencesSolaires:0, 
			SciencesStellaires_max: +values.SciencesStellaires > 0 ? +values.Science + +values.SciencesStellaires:0, 
		});
   });
});

on("change:Negociation change:Baration change:Bureaucratie change:Comedie change:Commerce change:Danse change:Eloquence change:Etiquette change:Jeux change:Seduction", function() {
    getAttrs(["Negociation", "Baration", "Bureaucratie", "Comedie", "Commerce", "Danse", "Eloquence", "Etiquette", "Jeux", "Seduction"], function(values) {
       setAttrs({
			Baration_max: +values.Negociation + +values.Baration, 
			Bureaucratie_max: +values.Negociation + +values.Bureaucratie, 
			Comedie_max: +values.Negociation + +values.Comedie, 
			Commerce_max: +values.Negociation + +values.Commerce, 
			Danse_max: +values.Negociation + +values.Danse, 
			Eloquence_max: +values.Negociation + +values.Eloquence, 
			Etiquette_max: +values.Negociation + +values.Etiquette, 
			Jeux_max: +values.Negociation + +values.Jeux, 
			Seduction_max: +values.Negociation + +values.Seduction, 
		});
   });
});

on("change:Trempe change:Commandement change:Demolition change:Determination change:Dressage change:Illegalites change:Intimidation change:Premierssoins change:Tactique change:Jeux change:Seduction", function() {
    getAttrs(["Trempe", "Commandement", "Demolition", "Determination", "Dressage", "Illegalites", "Intimidation", "Premierssoins", "Tactique", "Jeux", "Seduction"], function(values) {
       setAttrs({
			Commandement_max: +values.Trempe + +values.Commandement, 
			Demolition_max: +values.Demolition > 0 ? +values.Trempe + +values.Demolition:0, 
			Determination_max: +values.Trempe + +values.Determination, 
			Dressage_max: +values.Trempe + +values.Dressage, 
			Illegalites_max: +values.Trempe + +values.Illegalites, 
			Intimidation_max: +values.Trempe + +values.Intimidation, 
			Premierssoins_max: +values.Trempe + +values.Premierssoins, 
			Tactique_max: +values.Trempe + +values.Tactique,
		});
   });
});

</script>
</body>

</html>