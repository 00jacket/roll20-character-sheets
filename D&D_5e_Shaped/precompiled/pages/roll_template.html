<rolltemplate class="sheet-rolltemplate-5eReshaped">
  <div class="rt-card">
    <div class="rt-header relative{{#action}} action{{/action}}{{#spell}} spell{{/spell}}{{#ability}} ability{{/ability}}{{#save}} save{{/save}}{{#deathsave}} deathsave{{/deathsave}}">
      <div class="rt-title pad-l-xxl pad-r-xxl">{{title}}</div>
      <div class="tooltip-position-wrapper">
        {{#spellconcentration}}
          <div class="col tooltip">
            <span class="pictos-custom concentration-icon center">y</span>

            <div class="tooltip-content-left tooltip-small small-label">
              <span>Concentration</span>
            </div>
          </div>
        {{/spellconcentration}}
        {{#spellritual}}
          <div class="col tooltip">
            <span class="pictos-custom ritual-icon center">r</span>

            <div class="tooltip-content-left tooltip-small small-label">
              <span>Ritual</span>
            </div>
          </div>
        {{/spellritual}}
      </div>
      {{#show_character_name}}
        <div class="rt-subheader">{{character_name}}</div>
      {{/show_character_name}}

      {{#spell}}
        <div class="rt-subheader">{{spellfriendlylevel}}{{#spell_cast_as_level}} (as {{spell_cast_as_level}}){{/spell_cast_as_level}}{{#spellschool}} &bullet; {{spellschool}}{{/spellschool}}{{#range}} &bullet; {{range}}{{/range}}</div>
        <div class="rt-subheader">
          {{#spell_components_verbal}}V{{/spell_components_verbal}}{{#spell_components_somatic}}{{#spell_components_verbal}}, {{/spell_components_verbal}}S{{/spell_components_somatic}}{{#spell_components_material}}{{#spell_components_verbal}}{{^spell_components_somatic}}, {{/spell_components_somatic}}{{/spell_components_verbal}}{{#spell_components_somatic}}, {{/spell_components_somatic}}M{{/spell_components_material}}
          {{#spell_components_material}} ({{spell_components_material}}){{/spell_components_material}}
        </div>
        <div class="rt-subheader">{{#spell_casting_time}}{{spell_casting_time}}{{/spell_casting_time}}{{#spellduration}} &bullet; {{spellduration}}{{/spellduration}}</div>
      {{/spell}}
      {{#action}}
        <div class="rt-subheader">{{reach}}{{#range}}{{#reach}} &bullet; {{/reach}}{{range}}{{/range}}{{#ammo}} &bullet; {{ammo}} ammo{{/ammo}}{{#target}} &bullet; {{target}}{{/target}}</div>
      {{/action}}
      {{#subheader}}
        <div class="rt-subheader">{{subheader}}{{#subheaderright}} &bullet; {{subheaderright}}{{/subheaderright}}</div>
      {{/subheader}}
      {{#subheader2}}
        <div class="rt-subheader">{{subheader2}}{{#subheaderright2}} &bullet; {{subheaderright2}}{{/subheaderright2}}</div>
      {{/subheader2}}
      {{#targetName}}
        <div class="rt-subheader">vs {{targetName}}</div>
      {{/targetName}}
    </div>
    {{#emote}}
      <p class="rt-emote">{{character_name}} {{emote}}</p>
    {{/emote}}
    <div class="rt-content">
      {{#spelldescription}}
        <div class="shaped-row">
          <div class="col rt-key">Description</div>
          <div class="col rt-value">{{spelldescription}}</div>
        </div>
      {{/spelldescription}}
      {{#spell}}
        {{#target}}
          <div class="shaped-row">
            <div class="col-33 rt-key">Target</div>
            <div class="col-67 rt-value">{{target}}</div>
          </div>
        {{/target}}
      {{/spell}}
      {{#aoe}}
        <div class="shaped-row">
          <div class="col-33 rt-key">AoE</div>
          <div class="col-67 rt-value">{{aoe}}</div>
        </div>
      {{/aoe}}
      {{#attack}}
        <div class="shaped-row">
          <div class="col-{{^attackadv}}100{{/attackadv}}{{#attackadv}}50{{/attackadv}}">
            <div class="output">{{attack}}</div>
          </div>
          {{#attackadv}}
            <div class="col-50 border-left">
              <div class="output">{{attackadv}}</div>
            </div>
          {{/attackadv}}
        </div>
        <div class="output-small-label">vs AC{{#targetAC}} {{targetAC}}{{/targetAC}}</div>
      {{/attack}}

      {{#save_condition}}
        <div class="shaped-row">
          <div class="col-33 rt-key">Save Condition</div>
          <div class="col-67 rt-value">{{save_condition}}</div>
        </div>
      {{/save_condition}}
      {{#save_dc}}
        <div class="output">
          <span class="no-class{{#hide_save_dc}} gm-info-inline-block{{/hide_save_dc}}">DC {{save_dc}}&nbsp;</span>{{save_stat}}
        </div>
      {{/save_dc}}

      {{#damage}}
        <div class="shaped-row">
          <div class="col-{{^second_damage}}100{{/second_damage}}{{#second_damage}}50{{/second_damage}}">
            <div class="output">{{damage}}
              {{#attack}}
                {{#rollWasCrit() attack}}
                  <span>+ {{crit_damage}}</span>
                {{/rollWasCrit() attack}}
                {{#rollWasCrit() attackadv}}
                  <span>+ {{crit_damage}}</span>
                {{/rollWasCrit() attackadv}}
              {{/attack}}
            </div>
            <div class="output-small-label">{{damage_type}}</div>
          </div>
          {{#second_damage}}
            <div class="col-50 border-left">
              <div class="output">{{second_damage}}
                {{#attack}}
                  {{#rollWasCrit() attack}}
                    <span>+ {{second_crit_damage}}</span>
                  {{/rollWasCrit() attack}}
                  {{#rollWasCrit() attackadv}}
                    <span>+ {{second_crit_damage}}</span>
                  {{/rollWasCrit() attackadv}}
                {{/attack}}
              </div>
              <div class="output-small-label">{{second_damage_type}}</div>
            </div>
          {{/second_damage}}
        </div>
      {{/damage}}
      {{#save_failure}}
        <div class="shaped-row{{#hide_save_failure}} gm-info-block{{/hide_save_failure}}">
          <div class="col-50 rt-key">Save Failure</div>
          <div class="col rt-value">{{save_failure}}</div>
        </div>
      {{/save_failure}}
      {{#save_success}}
        <div class="shaped-row{{#hide_save_success}} gm-info-block{{/hide_save_success}}">
          <div class="col-33 rt-key">Save Success</div>
          <div class="col-67 rt-value">{{save_success}}</div>
        </div>
      {{/save_success}}
      {{#spellhealing}}
        <div class="shaped-row">
          <div class="col-33 rt-key">Healing</div>
          <div class="col-67 rt-value">{{spellhealing}} HP healed</div>
        </div>
      {{/spellhealing}}
      {{#effects}}
        <div class="shaped-row{{#hide_effects}} gm-info-block{{/hide_effects}}">
          <div class="col-33 rt-key">Effect</div>
          <div class="col rt-value">{{effects}}</div>
        </div>
      {{/effects}}
      {{#recharge}}
        <div class="shaped-row{{#hide_recharge}} gm-info-block{{/hide_recharge}}">
          <div class="col-33 rt-key smaller-letter-spacing">Recharge</div>
          <div class="col-67 rt-value">{{recharge}}</div>
        </div>
      {{/recharge}}

      {{#spellhigherlevel}}
        <div class="shaped-row">
          <div class="col rt-key">At Higher Levels</div>
          <div class="col rt-value">{{spellhigherlevel}}</div>
        </div>
      {{/spellhigherlevel}}

      {{#freetext}}
        <div class="shaped-row">
          <div class="col rt-key">{{freetextname}}</div>
          <div class="col rt-value">{{freetext}}</div>
        </div>
      {{/freetext}}
      {{#roll}}
        <div class="shaped-row">
          <div class="col-33 rt-key">{{rollname}}</div>
          <div class="col-67 rt-value">{{roll}}{{#rolladv}} | {{rolladv}}{{/rolladv}}</div>
        </div>
      {{/roll}}

      {{#allprops() classaction freetext freetextname character_name save title show_character_name subheader subheaderright subheader2 subheaderright2 rollname roll rolladv ability emote deathsave targetAC targetName attack action type damage damage_type crit_damage crit_damage_adv second_damage second_damage_type second_crit_damage second_crit_damage_adv ranged attackadv damage critdamage target aoe reach range ammo ammo_auto ammo_field spell save_condition save_dc save save_stat save_success save_failure save_second_damage save_second_damage_type spellfriendlylevel spellschool spellconcentration spellritual spelldescription spellhigherlevel spell_cast_as_level spellhealing spell_casting_time spellduration spell_components_verbal spell_components_somatic spell_components_material effects hide_save_dc hide_save_failure hide_save_success hide_effects recharge hide_recharge}}
        <div class="shaped-row">
          <div class="col-33 rt-key">{{key}}</div>
          <div class="col-67 rt-value">{{value}}</div>
        </div>
      {{/allprops() classaction freetext freetextname character_name save title show_character_name subheader subheaderright subheader2 subheaderright2 rollname roll rolladv ability emote deathsave targetAC targetName attack action type damage damage_type crit_damage crit_damage_adv second_damage second_damage_type second_crit_damage second_crit_damage_adv ranged attackadv damage critdamage target aoe reach range ammo ammo_auto ammo_field spell save_condition save_dc save save_stat save_success save_failure save_second_damage save_second_damage_type spellfriendlylevel spellschool spellconcentration spellritual spelldescription spellhigherlevel spell_cast_as_level spellhealing spell_casting_time spellduration spell_components_verbal spell_components_somatic spell_components_material effects hide_save_dc hide_save_failure hide_save_success hide_effects recharge hide_recharge}}

      {{#outputall}}
        {{#allprops() outputall title subheader subheaderright subheader2 subheaderright2 emote spell ability save deathsave}}
          <div class="shaped-row">
            <div class="col-33 rt-key">{{key}}</div>
            <div class="col-67 rt-value">{{value}}</div>
          </div>
        {{/allprops() outputall title subheader subheaderright subheader2 subheaderright2 emote spell ability save deathsave}}
      {{/outputall}}
    </div>
  </div>
</rolltemplate>